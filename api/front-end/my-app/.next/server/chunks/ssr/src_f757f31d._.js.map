{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/curation/components/ArticlesTable.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useEffect } from 'react';\nimport { CheckIcon, XMarkIcon, ClockIcon, ExclamationTriangleIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../../../lib/api';\n\ninterface Article {\n  id: number;\n  filename: string;\n  pubmed_id: number | null;\n  created_on: string;\n  modified_on: string;\n  curation_status: 'pending' | 'processing' | 'completed' | 'failed';\n  curation_error: string | null;\n  approximate_tokens: number;\n}\n\ninterface ArticlesTableProps {\n  articles: Article[];\n  selectedArticles: number[];\n  onSelectionChange: (selected: number[]) => void;\n  loading: boolean;\n  onRefresh: () => void;\n  onErrorClick?: (articleId: number) => void;\n  onRetryClick?: (articleId: number) => void;\n  isPolling?: boolean;\n}\n\nexport function ArticlesTable({ \n  articles, \n  selectedArticles, \n  onSelectionChange, \n  loading,\n  onRefresh,\n  onErrorClick,\n  onRetryClick,\n  isPolling = false\n}: ArticlesTableProps) {\n  const [sortConfig, setSortConfig] = useState<{\n    key: keyof Article;\n    direction: 'asc' | 'desc';\n  }>({\n    key: 'modified_on',\n    direction: 'desc'\n  });\n\n  const [retryingArticles, setRetryingArticles] = useState<Set<number>>(new Set());\n\n  // Note: Auto-refresh is handled by the parent component's polling hook\n\n  const handleSelectAll = useCallback(() => {\n    if (selectedArticles.length === articles.length) {\n      onSelectionChange([]);\n    } else {\n      const selectableArticles = articles\n        .filter(article => article.curation_status !== 'processing')\n        .slice(0, 20)\n        .map(article => article.id);\n      onSelectionChange(selectableArticles);\n    }\n  }, [articles, selectedArticles, onSelectionChange]);\n\n  const handleArticleSelect = useCallback((articleId: number) => {\n    const article = articles.find(a => a.id === articleId);\n    if (article?.curation_status === 'processing') return;\n\n    if (selectedArticles.includes(articleId)) {\n      onSelectionChange(selectedArticles.filter(id => id !== articleId));\n    } else if (selectedArticles.length < 20) {\n      onSelectionChange([...selectedArticles, articleId]);\n    }\n  }, [articles, selectedArticles, onSelectionChange]);\n\n  const handleRetry = useCallback(async (articleId: number) => {\n    if (!onRetryClick) return;\n    \n    setRetryingArticles(prev => new Set(prev).add(articleId));\n    \n    try {\n      await onRetryClick(articleId);\n      // Refresh immediately since backend sets status to processing right away\n      onRefresh();\n    } catch (error) {\n      console.error('Retry failed:', error);\n    } finally {\n      setRetryingArticles(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(articleId);\n        return newSet;\n      });\n    }\n  }, [onRetryClick, onRefresh]);\n\n  const getStatusIndicator = (article: Article) => {\n    // Show processing icon if article is being retried (optimistic update)\n    if (retryingArticles.has(article.id)) {\n      return (\n        <ClockIcon className=\"h-4 w-4 text-blue-500 animate-pulse\" />\n      );\n    }\n    \n    switch (article.curation_status) {\n      case 'completed':\n        return (\n          <span className=\"inline-block w-4 h-4 rounded-full bg-green-200\" />\n        );\n      case 'pending':\n        return (\n          <span className=\"inline-block w-4 h-4 rounded-full bg-blue-200\" />\n        );\n      case 'failed':\n        return (\n          <div className=\"flex items-center space-x-2\">\n            <button\n              onClick={() => onErrorClick?.(article.id)}\n              className=\"flex items-center hover:bg-red-50 p-1 rounded transition-colors\"\n              title=\"Click to view error details\"\n            >\n              <ExclamationTriangleIcon className=\"h-4 w-4 text-red-500\" />\n            </button>\n            {onRetryClick && (\n              <button\n                onClick={() => handleRetry(article.id)}\n                disabled={retryingArticles.has(article.id)}\n                className=\"flex items-center hover:bg-blue-50 p-1 rounded transition-colors disabled:opacity-50\"\n                title=\"Retry curation\"\n              >\n                <span className=\"text-blue-600 text-xs font-medium\">↻</span>\n              </button>\n            )}\n          </div>\n        );\n      case 'processing':\n        return (\n          <ClockIcon className=\"h-4 w-4 text-blue-500 animate-pulse\" />\n        );\n      default:\n        return null;\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric'\n    });\n  };\n\n  const sortedArticles = [...articles].sort((a, b) => {\n    const aValue = a[sortConfig.key];\n    const bValue = b[sortConfig.key];\n    \n    // Handle null values\n    if (aValue === null && bValue === null) return 0;\n    if (aValue === null) return sortConfig.direction === 'asc' ? 1 : -1;\n    if (bValue === null) return sortConfig.direction === 'asc' ? -1 : 1;\n    \n    if (sortConfig.direction === 'asc') {\n      return aValue < bValue ? -1 : 1;\n    } else {\n      return aValue > bValue ? -1 : 1;\n    }\n  });\n\n  if (loading) {\n    return (\n      <div className=\"bg-white shadow rounded-lg p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-4 bg-gray-200 rounded w-1/4 mb-4\"></div>\n          <div className=\"space-y-3\">\n            {[...Array(5)].map((_, i) => (\n              <div key={i} className=\"h-4 bg-gray-200 rounded\"></div>\n            ))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white shadow rounded-lg overflow-hidden\">\n      <div className=\"px-6 py-4 border-b border-gray-200\">\n        <div className=\"flex justify-between items-center\">\n          <div className=\"flex items-center space-x-4\">\n            <h2 className=\"text-lg font-medium text-gray-900\">Articles</h2>\n            {isPolling && (\n              <div className=\"flex items-center text-sm text-blue-600\">\n                <div className=\"w-2 h-2 bg-blue-600 rounded-full mr-2 animate-pulse\"></div>\n                Live updates\n              </div>\n            )}\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <span className=\"text-sm text-gray-500\">\n              {selectedArticles.length} of {articles.length} selected\n              {selectedArticles.length > 0 && ` (max 20)`}\n            </span>\n            <button\n              onClick={onRefresh}\n              disabled={loading}\n              className=\"text-blue-600 hover:text-blue-800 text-sm font-medium disabled:opacity-50\"\n            >\n              {loading ? 'Refreshing...' : 'Refresh'}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th className=\"px-6 py-2 text-left\">\n                <input\n                  type=\"checkbox\"\n                  checked={selectedArticles.length === articles.length && articles.length > 0}\n                  onChange={handleSelectAll}\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                />\n              </th>\n              <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Filename\n              </th>\n              <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                PubMed ID\n              </th>\n              <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Tokens\n              </th>\n              <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Created\n              </th>\n              <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Modified\n              </th>\n              <th className=\"px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                Status\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {sortedArticles.map((article) => (\n              <tr \n                key={article.id}\n                className={`hover:bg-gray-50 transition-colors ${\n                  selectedArticles.includes(article.id) ? 'bg-blue-50' : ''\n                } ${\n                  article.curation_status === 'processing' || retryingArticles.has(article.id) ? 'bg-blue-25' : ''\n                }`}\n              >\n                <td className=\"px-6 py-2 whitespace-nowrap\">\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedArticles.includes(article.id)}\n                    onChange={() => handleArticleSelect(article.id)}\n                    disabled={article.curation_status === 'processing' || retryingArticles.has(article.id)}\n                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50\"\n                  />\n                </td>\n                <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-900\">\n                  {article.filename}\n                </td>\n                <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-900\">\n                  {article.pubmed_id || '-'}\n                </td>\n                <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-900\">\n                  {article.approximate_tokens.toLocaleString()}\n                </td>\n                <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-900\">\n                  {formatDate(article.created_on)}\n                </td>\n                <td className=\"px-6 py-2 whitespace-nowrap text-sm text-gray-900\">\n                  {formatDate(article.modified_on)}\n                </td>\n                <td className=\"px-6 py-2 whitespace-nowrap text-sm\">\n                  {getStatusIndicator(article)}\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      {articles.length === 0 && (\n        <div className=\"p-6 text-center text-gray-500\">\n          No articles available for curation.\n        </div>\n      )}\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 505, "column": 0}, "map": {"version":3,"sources":["file:///app/src/lib/api.ts"],"sourcesContent":["const isDev = process.env.NODE_ENV === 'development';\n\nconst API_BASE_URL = isDev\n  ? 'http://localhost:8000'\n  : process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';\n\nexport const API_ENDPOINTS = {\n  // Curation endpoints\n  CURATION: {\n    BASE: `${API_BASE_URL}/api/curation`,\n    ARTICLES: `${API_BASE_URL}/api/curation/articles/`,\n    STATUS: `${API_BASE_URL}/api/curation/status/`,\n    BULK_CURATE: `${API_BASE_URL}/api/curation/bulk_curate/`,\n    ERROR_DETAILS: (articleId: number) => `${API_BASE_URL}/api/curation/${articleId}/error_details/`,\n    RETRY: (articleId: number) => `${API_BASE_URL}/api/curation/${articleId}/retry/`,\n    CELLLINES: (articleId: number) => `${API_BASE_URL}/api/curation/${articleId}/celllines/`,\n    SAVE_CELLLINE: (celllineId: string) => `${API_BASE_URL}/api/curation/celllines/${celllineId}/`,\n  },\n  // Editor endpoints (for reference)\n  EDITOR: {\n    CELLLINES: `${API_BASE_URL}/api/editor/celllines/`,\n    CELLLINE: (id: string) => `${API_BASE_URL}/api/editor/celllines/${id}/`,\n    SCHEMA: `${API_BASE_URL}/api/editor/cellline-schema/`,\n    NEW_TEMPLATE: `${API_BASE_URL}/api/editor/celllines/new_template/`,\n    VERSIONS: (id: string) => `${API_BASE_URL}/api/editor/celllines/${id}/versions/`,\n    VERSION: (id: string, version: string) => `${API_BASE_URL}/api/editor/celllines/${id}/versions/${version}/`,\n  },\n  // Transcription endpoints\n  TRANSCRIPTION: {\n    ARTICLES: `${API_BASE_URL}/api/articles/`,\n    CREATE_ARTICLE: `${API_BASE_URL}/api/transcription/create_article/`,\n  },\n};\n\nexport default API_ENDPOINTS; "],"names":[],"mappings":";;;;AAAA,MAAM,QAAQ,oDAAyB;AAEvC,MAAM,eAAe,uCACjB;AAGG,MAAM,gBAAgB;IAC3B,qBAAqB;IACrB,UAAU;QACR,MAAM,GAAG,aAAa,aAAa,CAAC;QACpC,UAAU,GAAG,aAAa,uBAAuB,CAAC;QAClD,QAAQ,GAAG,aAAa,qBAAqB,CAAC;QAC9C,aAAa,GAAG,aAAa,0BAA0B,CAAC;QACxD,eAAe,CAAC,YAAsB,GAAG,aAAa,cAAc,EAAE,UAAU,eAAe,CAAC;QAChG,OAAO,CAAC,YAAsB,GAAG,aAAa,cAAc,EAAE,UAAU,OAAO,CAAC;QAChF,WAAW,CAAC,YAAsB,GAAG,aAAa,cAAc,EAAE,UAAU,WAAW,CAAC;QACxF,eAAe,CAAC,aAAuB,GAAG,aAAa,wBAAwB,EAAE,WAAW,CAAC,CAAC;IAChG;IACA,mCAAmC;IACnC,QAAQ;QACN,WAAW,GAAG,aAAa,sBAAsB,CAAC;QAClD,UAAU,CAAC,KAAe,GAAG,aAAa,sBAAsB,EAAE,GAAG,CAAC,CAAC;QACvE,QAAQ,GAAG,aAAa,4BAA4B,CAAC;QACrD,cAAc,GAAG,aAAa,mCAAmC,CAAC;QAClE,UAAU,CAAC,KAAe,GAAG,aAAa,sBAAsB,EAAE,GAAG,UAAU,CAAC;QAChF,SAAS,CAAC,IAAY,UAAoB,GAAG,aAAa,sBAAsB,EAAE,GAAG,UAAU,EAAE,QAAQ,CAAC,CAAC;IAC7G;IACA,0BAA0B;IAC1B,eAAe;QACb,UAAU,GAAG,aAAa,cAAc,CAAC;QACzC,gBAAgB,GAAG,aAAa,kCAAkC,CAAC;IACrE;AACF;uCAEe","debugId":null}},
    {"offset": {"line": 545, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/curation/components/CurationActions.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { API_ENDPOINTS } from '../../../../lib/api';\n\ninterface CurationActionsProps {\n  selectedArticles: number[];\n  onCurationStart: () => void;\n  isProcessing?: boolean;\n}\n\nexport function CurationActions({ selectedArticles, onCurationStart, isProcessing: externalIsProcessing }: CurationActionsProps) {\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [showConfirmation, setShowConfirmation] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleStartCuration = async () => {\n    if (selectedArticles.length === 0) {\n      setError('Please select at least one article to curate.');\n      return;\n    }\n\n    if (selectedArticles.length > 20) {\n      setError('Maximum 20 articles can be curated at once.');\n      return;\n    }\n\n    setShowConfirmation(true);\n  };\n\n  const confirmCuration = async () => {\n    setIsProcessing(true);\n    setError(null);\n    setShowConfirmation(false);\n\n    try {\n      const response = await fetch(API_ENDPOINTS.CURATION.BULK_CURATE, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          article_ids: selectedArticles\n        }),\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to start curation');\n      }\n\n      onCurationStart();\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to start curation');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <div className=\"mt-6 bg-white shadow rounded-lg p-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-lg font-medium text-gray-900\">Curation Actions</h3>\n          <p className=\"text-sm text-gray-500 mt-1\">\n            {selectedArticles.length} article{selectedArticles.length !== 1 ? 's' : ''} selected\n            {selectedArticles.length > 0 && ` (${selectedArticles.length}/20)`}\n          </p>\n        </div>\n        \n        <button\n          onClick={handleStartCuration}\n          disabled={selectedArticles.length === 0 || isProcessing || externalIsProcessing}\n          className={`\n            inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md\n            ${selectedArticles.length === 0 || isProcessing || externalIsProcessing\n              ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\n              : 'bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500'\n            }\n          `}\n        >\n          {(isProcessing || externalIsProcessing) ? (\n            <>\n              <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n              </svg>\n              Processing...\n            </>\n          ) : (\n            <>\n              <svg className=\"-ml-1 mr-2 h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <polygon points=\"5,4 15,12 5,20\"/>\n              </svg>\n              Start Curation\n            </>\n          )}\n        </button>\n      </div>\n\n      {error && (\n        <div className=\"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg\">\n          <p className=\"text-red-700 text-sm\">{error}</p>\n        </div>\n      )}\n\n      {selectedArticles.length > 0 && (\n        <div className=\"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n          <p className=\"text-blue-700 text-sm\">\n            <strong>Note:</strong> Curation processing may take up to 5 minutes per article. \n            You can monitor progress in the articles table above.\n          </p>\n        </div>\n      )}\n\n      {/* Confirmation Modal */}\n      {showConfirmation && (\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\n          <div className=\"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white\">\n            <div className=\"mt-3 text-center\">\n              <h3 className=\"text-lg font-medium text-gray-900\">Confirm Curation</h3>\n              <div className=\"mt-2 px-7 py-3\">\n                <p className=\"text-sm text-gray-500\">\n                  Are you sure you want to start curation for {selectedArticles.length} article{selectedArticles.length !== 1 ? 's' : ''}?\n                  This process may take several minutes to complete.\n                </p>\n              </div>\n              <div className=\"items-center px-4 py-3\">\n                <button\n                  onClick={confirmCuration}\n                  className=\"px-4 py-2 bg-blue-600 text-white text-base font-medium rounded-md w-24 mr-2 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  Confirm\n                </button>\n                <button\n                  onClick={() => setShowConfirmation(false)}\n                  className=\"px-4 py-2 bg-gray-300 text-gray-700 text-base font-medium rounded-md w-24 hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500\"\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 845, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/curation/components/ErrorModal.tsx"],"sourcesContent":["'use client';\n\nimport { Fragment } from 'react';\nimport { Dialog, Transition } from '@headlessui/react';\nimport { XMarkIcon, ExclamationTriangleIcon } from '@heroicons/react/24/outline';\n\ninterface ErrorDetails {\n  article_id: number;\n  error_message: string;\n  curation_status: string;\n  failed_at: string;\n  filename?: string;\n  pubmed_id?: number | null;\n}\n\ninterface ErrorModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  errorDetails: ErrorDetails | null;\n  loading?: boolean;\n}\n\nexport function ErrorModal({ isOpen, onClose, errorDetails, loading = false }: ErrorModalProps) {\n  const categorizeError = (errorMessage: string) => {\n    const lowerError = errorMessage.toLowerCase();\n    \n    if (lowerError.includes('openai') || lowerError.includes('api key') || lowerError.includes('token limit')) {\n      return {\n        category: 'OpenAI API Error',\n        severity: 'high',\n        description: 'Issue with OpenAI API integration'\n      };\n    } else if (lowerError.includes('parsing') || lowerError.includes('json') || lowerError.includes('format')) {\n      return {\n        category: 'Data Processing Error',\n        severity: 'medium',\n        description: 'Issue with data parsing or formatting'\n      };\n    } else if (lowerError.includes('timeout') || lowerError.includes('connection')) {\n      return {\n        category: 'Network Error',\n        severity: 'medium',\n        description: 'Network connectivity issue'\n      };\n    } else {\n      return {\n        category: 'Application Error',\n        severity: 'low',\n        description: 'General application error'\n      };\n    }\n  };\n\n  const getSeverityColor = (severity: string) => {\n    switch (severity) {\n      case 'high':\n        return 'text-red-600 bg-red-50 border-red-200';\n      case 'medium':\n        return 'text-yellow-600 bg-yellow-50 border-yellow-200';\n      case 'low':\n        return 'text-blue-600 bg-blue-50 border-blue-200';\n      default:\n        return 'text-gray-600 bg-gray-50 border-gray-200';\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleString('en-US', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit'\n    });\n  };\n\n  return (\n    <Transition.Root show={isOpen} as={Fragment}>\n      <Dialog as=\"div\" className=\"relative z-50\" onClose={onClose}>\n        <Transition.Child\n          as={Fragment}\n          enter=\"ease-out duration-300\"\n          enterFrom=\"opacity-0\"\n          enterTo=\"opacity-100\"\n          leave=\"ease-in duration-200\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n        >\n          <div className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\" />\n        </Transition.Child>\n\n        <div className=\"fixed inset-0 z-10 overflow-y-auto\">\n          <div className=\"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0\">\n            <Transition.Child\n              as={Fragment}\n              enter=\"ease-out duration-300\"\n              enterFrom=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n              enterTo=\"opacity-100 translate-y-0 sm:scale-100\"\n              leave=\"ease-in duration-200\"\n              leaveFrom=\"opacity-100 translate-y-0 sm:scale-100\"\n              leaveTo=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n            >\n              <Dialog.Panel className=\"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-2xl sm:p-6\">\n                <div className=\"absolute right-0 top-0 hidden pr-4 pt-4 sm:block\">\n                  <button\n                    type=\"button\"\n                    className=\"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\n                    onClick={onClose}\n                  >\n                    <span className=\"sr-only\">Close</span>\n                    <XMarkIcon className=\"h-6 w-6\" aria-hidden=\"true\" />\n                  </button>\n                </div>\n\n                {loading ? (\n                  <div className=\"flex items-center justify-center py-8\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n                    <span className=\"ml-3 text-gray-600\">Loading error details...</span>\n                  </div>\n                ) : errorDetails ? (\n                  <div>\n                    <div className=\"flex items-center\">\n                      <div className=\"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10\">\n                        <ExclamationTriangleIcon className=\"h-6 w-6 text-red-600\" aria-hidden=\"true\" />\n                      </div>\n                      <div className=\"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left\">\n                        <Dialog.Title as=\"h3\" className=\"text-lg font-medium leading-6 text-gray-900\">\n                          Curation Error Details\n                        </Dialog.Title>\n                      </div>\n                    </div>\n\n                    <div className=\"mt-6 space-y-6\">\n                      {/* Article Information */}\n                      <div className=\"bg-gray-50 rounded-lg p-4\">\n                        <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Article Information</h4>\n                        <dl className=\"grid grid-cols-1 gap-x-4 gap-y-2 text-sm\">\n                          <div>\n                            <dt className=\"font-medium text-gray-500\">Article ID:</dt>\n                            <dd className=\"text-gray-900\">{errorDetails.article_id}</dd>\n                          </div>\n                          {errorDetails.filename && (\n                            <div>\n                              <dt className=\"font-medium text-gray-500\">Filename:</dt>\n                              <dd className=\"text-gray-900\">{errorDetails.filename}</dd>\n                            </div>\n                          )}\n                          {errorDetails.pubmed_id && (\n                            <div>\n                              <dt className=\"font-medium text-gray-500\">PubMed ID:</dt>\n                              <dd className=\"text-gray-900\">{errorDetails.pubmed_id}</dd>\n                            </div>\n                          )}\n                          <div>\n                            <dt className=\"font-medium text-gray-500\">Failed At:</dt>\n                            <dd className=\"text-gray-900\">{formatDate(errorDetails.failed_at)}</dd>\n                          </div>\n                        </dl>\n                      </div>\n\n                      {/* Error Categorization */}\n                      {(() => {\n                        const errorInfo = categorizeError(errorDetails.error_message);\n                        return (\n                          <div className={`rounded-lg p-4 border ${getSeverityColor(errorInfo.severity)}`}>\n                            <h4 className=\"text-sm font-medium mb-2\">Error Category</h4>\n                            <p className=\"text-sm font-medium\">{errorInfo.category}</p>\n                            <p className=\"text-sm mt-1\">{errorInfo.description}</p>\n                          </div>\n                        );\n                      })()}\n\n                      {/* Error Message */}\n                      <div>\n                        <h4 className=\"text-sm font-medium text-gray-900 mb-2\">Error Message</h4>\n                        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n                          <pre className=\"text-sm text-red-800 whitespace-pre-wrap font-mono\">\n                            {errorDetails.error_message}\n                          </pre>\n                        </div>\n                      </div>\n\n                      {/* Troubleshooting Tips */}\n                      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                        <h4 className=\"text-sm font-medium text-blue-900 mb-2\">Troubleshooting Tips</h4>\n                        <ul className=\"text-sm text-blue-800 space-y-1\">\n                          <li>• Check if the article content is properly formatted</li>\n                          <li>• Verify that the transcription process completed successfully</li>\n                          <li>• Contact support if the error persists</li>\n                          <li>• You can retry curation once the issue is resolved</li>\n                        </ul>\n                      </div>\n                    </div>\n\n                    <div className=\"mt-6 flex justify-end space-x-3\">\n                      <button\n                        type=\"button\"\n                        className=\"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\n                        onClick={onClose}\n                      >\n                        Close\n                      </button>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <p className=\"text-gray-500\">No error details available.</p>\n                  </div>\n                )}\n              </Dialog.Panel>\n            </Transition.Child>\n          </div>\n        </div>\n      </Dialog>\n    </Transition.Root>\n  );\n} "],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AACA;AAAA;AAJA;;;;;AAsBO,SAAS,WAAW,EAAE,MAAM,EAAE,OAAO,EAAE,YAAY,EAAE,UAAU,KAAK,EAAmB;IAC5F,MAAM,kBAAkB,CAAC;QACvB,MAAM,aAAa,aAAa,WAAW;QAE3C,IAAI,WAAW,QAAQ,CAAC,aAAa,WAAW,QAAQ,CAAC,cAAc,WAAW,QAAQ,CAAC,gBAAgB;YACzG,OAAO;gBACL,UAAU;gBACV,UAAU;gBACV,aAAa;YACf;QACF,OAAO,IAAI,WAAW,QAAQ,CAAC,cAAc,WAAW,QAAQ,CAAC,WAAW,WAAW,QAAQ,CAAC,WAAW;YACzG,OAAO;gBACL,UAAU;gBACV,UAAU;gBACV,aAAa;YACf;QACF,OAAO,IAAI,WAAW,QAAQ,CAAC,cAAc,WAAW,QAAQ,CAAC,eAAe;YAC9E,OAAO;gBACL,UAAU;gBACV,UAAU;gBACV,aAAa;YACf;QACF,OAAO;YACL,OAAO;gBACL,UAAU;gBACV,UAAU;gBACV,aAAa;YACf;QACF;IACF;IAEA,MAAM,mBAAmB,CAAC;QACxB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,MAAM,aAAa,CAAC;QAClB,OAAO,IAAI,KAAK,YAAY,cAAc,CAAC,SAAS;YAClD,MAAM;YACN,OAAO;YACP,KAAK;YACL,MAAM;YACN,QAAQ;YACR,QAAQ;QACV;IACF;IAEA,qBACE,8OAAC,uLAAA,CAAA,aAAU,CAAC,IAAI;QAAC,MAAM;QAAQ,IAAI,qMAAA,CAAA,WAAQ;kBACzC,cAAA,8OAAC,+KAAA,CAAA,SAAM;YAAC,IAAG;YAAM,WAAU;YAAgB,SAAS;;8BAClD,8OAAC,uLAAA,CAAA,aAAU,CAAC,KAAK;oBACf,IAAI,qMAAA,CAAA,WAAQ;oBACZ,OAAM;oBACN,WAAU;oBACV,SAAQ;oBACR,OAAM;oBACN,WAAU;oBACV,SAAQ;8BAER,cAAA,8OAAC;wBAAI,WAAU;;;;;;;;;;;8BAGjB,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC,uLAAA,CAAA,aAAU,CAAC,KAAK;4BACf,IAAI,qMAAA,CAAA,WAAQ;4BACZ,OAAM;4BACN,WAAU;4BACV,SAAQ;4BACR,OAAM;4BACN,WAAU;4BACV,SAAQ;sCAER,cAAA,8OAAC,+KAAA,CAAA,SAAM,CAAC,KAAK;gCAAC,WAAU;;kDACtB,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC;4CACC,MAAK;4CACL,WAAU;4CACV,SAAS;;8DAET,8OAAC;oDAAK,WAAU;8DAAU;;;;;;8DAC1B,8OAAC,iNAAA,CAAA,YAAS;oDAAC,WAAU;oDAAU,eAAY;;;;;;;;;;;;;;;;;oCAI9C,wBACC,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAI,WAAU;;;;;;0DACf,8OAAC;gDAAK,WAAU;0DAAqB;;;;;;;;;;;+CAErC,6BACF,8OAAC;;0DACC,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDAAI,WAAU;kEACb,cAAA,8OAAC,6OAAA,CAAA,0BAAuB;4DAAC,WAAU;4DAAuB,eAAY;;;;;;;;;;;kEAExE,8OAAC;wDAAI,WAAU;kEACb,cAAA,8OAAC,+KAAA,CAAA,SAAM,CAAC,KAAK;4DAAC,IAAG;4DAAK,WAAU;sEAA8C;;;;;;;;;;;;;;;;;0DAMlF,8OAAC;gDAAI,WAAU;;kEAEb,8OAAC;wDAAI,WAAU;;0EACb,8OAAC;gEAAG,WAAU;0EAAyC;;;;;;0EACvD,8OAAC;gEAAG,WAAU;;kFACZ,8OAAC;;0FACC,8OAAC;gFAAG,WAAU;0FAA4B;;;;;;0FAC1C,8OAAC;gFAAG,WAAU;0FAAiB,aAAa,UAAU;;;;;;;;;;;;oEAEvD,aAAa,QAAQ,kBACpB,8OAAC;;0FACC,8OAAC;gFAAG,WAAU;0FAA4B;;;;;;0FAC1C,8OAAC;gFAAG,WAAU;0FAAiB,aAAa,QAAQ;;;;;;;;;;;;oEAGvD,aAAa,SAAS,kBACrB,8OAAC;;0FACC,8OAAC;gFAAG,WAAU;0FAA4B;;;;;;0FAC1C,8OAAC;gFAAG,WAAU;0FAAiB,aAAa,SAAS;;;;;;;;;;;;kFAGzD,8OAAC;;0FACC,8OAAC;gFAAG,WAAU;0FAA4B;;;;;;0FAC1C,8OAAC;gFAAG,WAAU;0FAAiB,WAAW,aAAa,SAAS;;;;;;;;;;;;;;;;;;;;;;;;oDAMrE,CAAC;wDACA,MAAM,YAAY,gBAAgB,aAAa,aAAa;wDAC5D,qBACE,8OAAC;4DAAI,WAAW,CAAC,sBAAsB,EAAE,iBAAiB,UAAU,QAAQ,GAAG;;8EAC7E,8OAAC;oEAAG,WAAU;8EAA2B;;;;;;8EACzC,8OAAC;oEAAE,WAAU;8EAAuB,UAAU,QAAQ;;;;;;8EACtD,8OAAC;oEAAE,WAAU;8EAAgB,UAAU,WAAW;;;;;;;;;;;;oDAGxD,CAAC;kEAGD,8OAAC;;0EACC,8OAAC;gEAAG,WAAU;0EAAyC;;;;;;0EACvD,8OAAC;gEAAI,WAAU;0EACb,cAAA,8OAAC;oEAAI,WAAU;8EACZ,aAAa,aAAa;;;;;;;;;;;;;;;;;kEAMjC,8OAAC;wDAAI,WAAU;;0EACb,8OAAC;gEAAG,WAAU;0EAAyC;;;;;;0EACvD,8OAAC;gEAAG,WAAU;;kFACZ,8OAAC;kFAAG;;;;;;kFACJ,8OAAC;kFAAG;;;;;;kFACJ,8OAAC;kFAAG;;;;;;kFACJ,8OAAC;kFAAG;;;;;;;;;;;;;;;;;;;;;;;;0DAKV,8OAAC;gDAAI,WAAU;0DACb,cAAA,8OAAC;oDACC,MAAK;oDACL,WAAU;oDACV,SAAS;8DACV;;;;;;;;;;;;;;;;6DAML,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC;4CAAE,WAAU;sDAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUjD","debugId":null}},
    {"offset": {"line": 1380, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/editor/components/ErrorBoundary.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\n\ninterface Props {\n  children: React.ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n}\n\nexport class ErrorBoundary extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    console.error('Editor Error Boundary caught an error:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-6 m-4\">\n          <div className=\"flex items-center mb-4\">\n            <div className=\"flex-shrink-0\">\n              <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800\">\n                Editor Error\n              </h3>\n              <div className=\"mt-2 text-sm text-red-700\">\n                <p>Something went wrong with the cell line editor. Please refresh the page or contact support if the problem persists.</p>\n                {process.env.NODE_ENV === 'development' && this.state.error && (\n                  <details className=\"mt-2\">\n                    <summary className=\"cursor-pointer\">Technical Details</summary>\n                    <pre className=\"mt-2 text-xs bg-red-100 p-2 rounded overflow-x-auto\">\n                      {this.state.error.stack}\n                    </pre>\n                  </details>\n                )}\n              </div>\n            </div>\n          </div>\n          <div className=\"flex\">\n            <button\n              onClick={() => this.setState({ hasError: false })}\n              className=\"bg-red-100 hover:bg-red-200 text-red-800 text-sm font-medium py-2 px-4 rounded transition-colors\"\n            >\n              Try Again\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n} "],"names":[],"mappings":";;;;AAEA;AAFA;;;AAaO,MAAM,sBAAsB,qMAAA,CAAA,UAAK,CAAC,SAAS;IAChD,YAAY,KAAY,CAAE;QACxB,KAAK,CAAC;QACN,IAAI,CAAC,KAAK,GAAG;YAAE,UAAU;QAAM;IACjC;IAEA,OAAO,yBAAyB,KAAY,EAAS;QACnD,OAAO;YAAE,UAAU;YAAM;QAAM;IACjC;IAEA,kBAAkB,KAAY,EAAE,SAA0B,EAAE;QAC1D,QAAQ,KAAK,CAAC,0CAA0C,OAAO;IACjE;IAEA,SAAS;QACP,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;YACvB,qBACE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAI,WAAU;oCAAuB,SAAQ;oCAAY,MAAK;8CAC7D,cAAA,8OAAC;wCAAK,UAAS;wCAAU,GAAE;wCAA0N,UAAS;;;;;;;;;;;;;;;;0CAGlQ,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAG,WAAU;kDAAmC;;;;;;kDAGjD,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;0DAAE;;;;;;4CACF,oDAAyB,iBAAiB,IAAI,CAAC,KAAK,CAAC,KAAK,kBACzD,8OAAC;gDAAQ,WAAU;;kEACjB,8OAAC;wDAAQ,WAAU;kEAAiB;;;;;;kEACpC,8OAAC;wDAAI,WAAU;kEACZ,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAOnC,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BACC,SAAS,IAAM,IAAI,CAAC,QAAQ,CAAC;oCAAE,UAAU;gCAAM;4BAC/C,WAAU;sCACX;;;;;;;;;;;;;;;;;QAMT;QAEA,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ;IAC5B;AACF","debugId":null}},
    {"offset": {"line": 1535, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/curation/hooks/useStatusPolling.ts"],"sourcesContent":["import { useState, useEffect, useCallback, useRef } from 'react';\nimport { API_ENDPOINTS } from '../../../../lib/api';\n\ninterface Article {\n  id: number;\n  filename: string;\n  pubmed_id: number | null;\n  created_on: string;\n  modified_on: string;\n  curation_status: 'pending' | 'processing' | 'completed' | 'failed';\n  curation_error: string | null;\n  curation_started_at: string | null;\n  transcription_status: string;\n  is_curated: boolean;\n  approximate_tokens: number;\n}\n\ninterface StatusResponse {\n  articles: Article[];\n  total_count: number;\n  processing_count: number;\n  completed_count: number;\n  failed_count: number;\n}\n\nexport function useStatusPolling(\n  initialArticles: Article[],\n  isPolling: boolean = false,\n  pollInterval: number = 3000\n) {\n  const [articles, setArticles] = useState<Article[]>(initialArticles);\n  const [status, setStatus] = useState<StatusResponse | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const pollingRef = useRef<NodeJS.Timeout | null>(null);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  // Sync internal articles state when initialArticles changes\n  useEffect(() => {\n    setArticles(initialArticles);\n  }, [initialArticles]);\n\n  const fetchStatus = useCallback(async (showLoading: boolean = true) => {\n    try {\n      if (showLoading) {\n        setLoading(true);\n      }\n      setError(null);\n      \n      // Cancel previous request if still pending\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n      \n      abortControllerRef.current = new AbortController();\n      \n      const response = await fetch(API_ENDPOINTS.CURATION.STATUS, {\n        signal: abortControllerRef.current.signal,\n        headers: {\n          'Cache-Control': 'no-cache',\n          'Pragma': 'no-cache'\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data: StatusResponse = await response.json();\n      setArticles(data.articles);\n      setStatus(data);\n    } catch (err) {\n      if (err instanceof Error && err.name === 'AbortError') {\n        // Request was cancelled, ignore\n        return;\n      }\n      setError(err instanceof Error ? err.message : 'Failed to fetch status');\n    } finally {\n      if (showLoading) {\n        setLoading(false);\n      }\n    }\n  }, []);\n\n  // Background fetch without loading state for seamless updates\n  const fetchStatusSilent = useCallback(() => {\n    fetchStatus(false);\n  }, [fetchStatus]);\n\n  const startPolling = useCallback(() => {\n    if (pollingRef.current) {\n      clearInterval(pollingRef.current);\n    }\n    \n    // Initial fetch with loading indicator\n    fetchStatus();\n    \n    // Start silent polling for seamless updates\n    pollingRef.current = setInterval(fetchStatusSilent, pollInterval);\n  }, [fetchStatus, fetchStatusSilent, pollInterval]);\n\n  const stopPolling = useCallback(() => {\n    if (pollingRef.current) {\n      clearInterval(pollingRef.current);\n      pollingRef.current = null;\n    }\n    \n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n      abortControllerRef.current = null;\n    }\n  }, []);\n\n  useEffect(() => {\n    if (isPolling) {\n      startPolling();\n    } else {\n      stopPolling();\n    }\n\n    return () => {\n      stopPolling();\n    };\n  }, [isPolling, startPolling, stopPolling]);\n\n  // Manual refresh function with loading indicator\n  const refresh = useCallback(() => {\n    fetchStatus(true);\n  }, [fetchStatus]);\n\n  return {\n    articles,\n    status,\n    loading,\n    error,\n    refresh,\n    startPolling,\n    stopPolling\n  };\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1656, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/editor/hooks/useSchemaData.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { FieldSchema } from '../types/editor';\n\nexport function useSchemaData() {\n  const [schema, setSchema] = useState<FieldSchema | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchSchema = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    \n    try {\n      const response = await fetch('http://localhost:8000/api/editor/cellline-schema/');\n      if (!response.ok) {\n        throw new Error(`Failed to fetch schema: ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      setSchema(data);\n      return data;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to fetch schema');\n      console.error('Error fetching schema:', err);\n      return null;\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchSchema();\n  }, [fetchSchema]);\n\n  return {\n    schema,\n    isLoading,\n    error,\n    refetch: fetchSchema,\n  };\n} "],"names":[],"mappings":";;;AAEA;AAFA;;AAKO,SAAS;IACd,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAsB;IACzD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAElD,MAAM,cAAc,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE;QAC9B,aAAa;QACb,SAAS;QAET,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM,CAAC,wBAAwB,EAAE,SAAS,UAAU,EAAE;YAClE;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,UAAU;YACV,OAAO;QACT,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;YAC9C,QAAQ,KAAK,CAAC,0BAA0B;YACxC,OAAO;QACT,SAAU;YACR,aAAa;QACf;IACF,GAAG,EAAE;IAEL,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR;IACF,GAAG;QAAC;KAAY;IAEhB,OAAO;QACL;QACA;QACA;QACA,SAAS;IACX;AACF","debugId":null}},
    {"offset": {"line": 1703, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/editor/components/ModalValueEditor.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useRef, useEffect } from 'react';\n\ninterface FieldSchema {\n  type: 'CharField' | 'JSONField' | 'IntegerField' | 'BooleanField';\n  required: boolean;\n  max_length?: number;\n  choices?: string[];\n  json_schema?: any;\n  help_text?: string;\n}\n\ninterface ModalValueEditorProps {\n  isOpen: boolean;\n  fieldName: string;\n  value: any;\n  fieldSchema?: FieldSchema;\n  onSave: (newValue: any) => void;\n  onCancel: () => void;\n}\n\nexport default function ModalValueEditor({\n  isOpen,\n  fieldName,\n  value,\n  fieldSchema,\n  onSave,\n  onCancel\n}: ModalValueEditorProps) {\n  const [editValue, setEditValue] = useState(value?.toString() || '');\n  const [error, setError] = useState<string | null>(null);\n  const inputRef = useRef<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>(null);\n\n  // Reset state when modal opens with new value\n  useEffect(() => {\n    if (isOpen) {\n      setEditValue(value?.toString() || '');\n      setError(null);\n    }\n  }, [isOpen, value]);\n\n  // Focus input when modal opens\n  useEffect(() => {\n    if (isOpen && inputRef.current) {\n      // Small delay to ensure modal is fully rendered\n      const timer = setTimeout(() => {\n        if (inputRef.current) {\n          inputRef.current.focus();\n          // Position cursor at the end instead of selecting all text\n          if ('setSelectionRange' in inputRef.current) {\n            const length = inputRef.current.value.length;\n            inputRef.current.setSelectionRange(length, length);\n          }\n        }\n      }, 100);\n      return () => clearTimeout(timer);\n    }\n  }, [isOpen]);\n\n  // Handle escape key\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleEscapeKey = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        onCancel();\n      }\n    };\n\n    document.addEventListener('keydown', handleEscapeKey);\n    return () => document.removeEventListener('keydown', handleEscapeKey);\n  }, [isOpen, onCancel]);\n\n  const validateValue = (val: string): string | null => {\n    if (!fieldSchema) return null;\n\n    if (fieldSchema.required && val.trim() === '') {\n      return 'This field is required';\n    }\n\n    if (fieldSchema.max_length && val.length > fieldSchema.max_length) {\n      return `Maximum length is ${fieldSchema.max_length} characters`;\n    }\n\n    if (fieldSchema.type === 'IntegerField') {\n      const num = parseInt(val, 10);\n      if (isNaN(num)) {\n        return 'Must be a valid integer';\n      }\n    }\n\n    return null;\n  };\n\n  const handleSave = () => {\n    const validationError = validateValue(editValue);\n    if (validationError) {\n      setError(validationError);\n      return;\n    }\n\n    let processedValue: any = editValue;\n\n    // Convert value based on field type\n    if (fieldSchema) {\n      switch (fieldSchema.type) {\n        case 'IntegerField':\n          processedValue = parseInt(editValue, 10);\n          break;\n        case 'BooleanField':\n          processedValue = editValue === 'true' || editValue === '1';\n          break;\n        case 'JSONField':\n          try {\n            processedValue = JSON.parse(editValue);\n          } catch {\n            setError('Invalid JSON format');\n            return;\n          }\n          break;\n        default:\n          processedValue = editValue;\n      }\n    }\n\n    onSave(processedValue);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSave();\n    }\n    // Escape is handled by the document listener\n  };\n\n  const handleBackdropClick = (e: React.MouseEvent) => {\n    if (e.target === e.currentTarget) {\n      onCancel();\n    }\n  };\n\n  const renderEditor = () => {\n    if (fieldSchema?.choices && fieldSchema.choices.length > 0) {\n      // Select dropdown for choice fields\n      return (\n        <select\n          ref={inputRef as React.RefObject<HTMLSelectElement>}\n          value={editValue}\n          onChange={(e) => setEditValue(e.target.value)}\n          onKeyDown={handleKeyDown}\n          className=\"w-full border border-gray-300 rounded-lg px-4 py-3 text-xs focus:outline-none\"\n        >\n          <option value=\"\">Select...</option>\n          {fieldSchema.choices.map((choice) => (\n            <option key={choice} value={choice}>\n              {choice}\n            </option>\n          ))}\n        </select>\n      );\n    }\n\n    if (fieldSchema?.type === 'BooleanField') {\n      // Boolean toggle\n      return (\n        <select\n          ref={inputRef as React.RefObject<HTMLSelectElement>}\n          value={editValue}\n          onChange={(e) => setEditValue(e.target.value)}\n          onKeyDown={handleKeyDown}\n          className=\"w-full border border-gray-300 rounded-lg px-4 py-3 text-xs focus:outline-none\"\n        >\n          <option value=\"true\">True</option>\n          <option value=\"false\">False</option>\n        </select>\n      );\n    }\n\n    if (fieldSchema?.type === 'JSONField' || (editValue && editValue.includes('\\n'))) {\n      // Textarea for multiline content\n      return (\n        <textarea\n          ref={inputRef as React.RefObject<HTMLTextAreaElement>}\n          value={editValue}\n          onChange={(e) => setEditValue(e.target.value)}\n          onKeyDown={handleKeyDown}\n          className=\"w-full border border-gray-300 rounded-lg px-4 py-3 text-xs focus:outline-none resize-none\"\n          rows={Math.min(Math.max(editValue.split('\\n').length + 1, 5), 12)}\n          placeholder=\"Enter value...\"\n        />\n      );\n    }\n\n    // Default text input - use textarea for better visibility of long content\n    return (\n      <textarea\n        ref={inputRef as React.RefObject<HTMLTextAreaElement>}\n        value={editValue}\n        onChange={(e) => setEditValue(e.target.value)}\n        onKeyDown={handleKeyDown}\n        className=\"w-full border border-gray-300 rounded-lg px-4 py-3 text-xs focus:outline-none resize-none\"\n        rows={3}\n        maxLength={fieldSchema?.max_length}\n        placeholder=\"Enter value...\"\n      />\n    );\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div\n      className=\"fixed inset-0 flex items-center justify-center z-50\"\n      onClick={handleBackdropClick}\n    >\n      <div className=\"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4\">\n        {/* Header */}\n        <div className=\"px-6 py-4 border-b border-gray-200\">\n          <h3 className=\"text-lg font-semibold text-gray-900\">\n            {fieldName}\n          </h3>\n          {fieldSchema?.help_text && (\n            <p className=\"text-sm text-gray-600 mt-1\">{fieldSchema.help_text}</p>\n          )}\n        </div>\n\n        {/* Content */}\n        <div className=\"px-6 py-4\">\n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Value\n              </label>\n              {renderEditor()}\n              {error && (\n                <div className=\"mt-2 text-sm text-red-600\">\n                  {error}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"px-6 py-4 border-t border-gray-200 bg-gray-50 rounded-b-lg\">\n          <div className=\"text-xs text-gray-500 text-center\">\n            Press <kbd className=\"bg-gray-200 px-1 rounded\">Enter</kbd> to save • <kbd className=\"bg-gray-200 px-1 rounded\">Esc</kbd> to cancel\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2037, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/editor/components/EditorLine.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { DisplayLine, FieldSchema } from '../types/editor';\nimport ModalValueEditor from './ModalValueEditor';\n\ninterface EditorLineProps {\n  line: DisplayLine;\n  schema: FieldSchema;\n  isEditing: boolean;\n  onToggleCollapse: () => void;\n  onStartEdit: () => void;\n  onCancelEdit: () => void;\n  onUpdateValue: (fieldPath: string[], newValue: any) => void;\n  onAddItem?: () => void;\n}\n\nexport default function EditorLine({\n  line,\n  schema,\n  isEditing,\n  onToggleCollapse,\n  onStartEdit,\n  onCancelEdit,\n  onUpdateValue,\n  onAddItem\n}: EditorLineProps) {\n  const [hovering, setHovering] = useState(false);\n\n  const getFieldSchema = () => {\n    const fieldName = line.fieldPath[0];\n    return schema[fieldName];\n  };\n\n  const getSyntaxHighlighting = () => {\n    const fieldSchema = getFieldSchema();\n    const value = line.value;\n\n    // Type-based highlighting\n    if (fieldSchema?.type === 'BooleanField') {\n      return 'text-purple-600 font-medium'; // Purple for booleans\n    }\n    \n    if (fieldSchema?.type === 'IntegerField') {\n      return 'text-orange-600 font-medium'; // Orange for numbers\n    }\n    \n    if (Array.isArray(value)) {\n      return 'text-green-600'; // Green for arrays\n    }\n    \n    if (typeof value === 'object' && value !== null) {\n      return 'text-indigo-600'; // Indigo for objects\n    }\n    \n    // Default for strings and other types\n    return 'text-gray-900';\n  };\n\n  const handleValueClick = () => {\n    if (line.isEditable && !isEditing) {\n      onStartEdit();\n    }\n  };\n\n  const handleCollapseClick = () => {\n    if (line.isCollapsible) {\n      onToggleCollapse();\n    }\n  };\n\n  const renderLineContent = () => {\n    const parts = line.displayText.split(': ');\n    const fieldPart = parts[0];\n    const valuePart = parts.slice(1).join(': ');\n\n    if (line.type === 'array_control') {\n      return (\n        <div \n          className=\"flex items-center text-green-600 cursor-pointer hover:text-green-800\"\n          title=\"Add new item to array\"\n          onClick={onAddItem}\n        >\n          <span>{line.displayText}</span>\n        </div>\n      );\n    }\n\n    if (line.isCollapsible) {\n      return (\n        <div className=\"flex items-center\">\n          <button\n            onClick={handleCollapseClick}\n            className=\"mr-2 text-gray-500 hover:text-gray-700 flex-shrink-0\"\n          >\n            {line.isCollapsed ? '▶' : '▼'}\n          </button>\n          <span className=\"text-blue-800 font-medium\">{fieldPart}:</span>\n        </div>\n      );\n    }\n\n    if (line.isEditable && valuePart !== undefined) {\n      return (\n        <div className=\"flex items-center\">\n          <span className=\"text-blue-800 font-medium mr-1\">{fieldPart}:</span>\n          <span\n            onClick={handleValueClick}\n            className={`cursor-pointer px-1 rounded border max-w-md truncate inline-block ${\n              hovering\n                ? 'bg-blue-50 border-blue-200 text-blue-900'\n                : 'hover:bg-gray-50 border-transparent'\n            } ${\n              valuePart.trim() === ''\n                ? 'text-gray-400 italic'\n                : getSyntaxHighlighting()\n            }`}\n            onMouseEnter={() => setHovering(true)}\n            onMouseLeave={() => setHovering(false)}\n            title={valuePart.trim() === '' ? '(empty)' : valuePart}\n          >\n            {valuePart.trim() === '' ? '(empty)' : valuePart}\n          </span>\n          <ModalValueEditor\n            isOpen={isEditing}\n            fieldName={fieldPart}\n            value={line.value}\n            fieldSchema={getFieldSchema()}\n            onSave={(newValue: any) => {\n              console.log('🟡 EditorLine onSave called, fieldPath:', line.fieldPath, 'newValue:', newValue);\n              onUpdateValue(line.fieldPath, newValue);\n            }}\n            onCancel={onCancelEdit}\n          />\n        </div>\n      );\n    }\n\n    return <span className=\"text-gray-800\">{line.displayText}</span>;\n  };\n\n  return (\n    <div className=\"flex items-center\">\n      {/* Line Number */}\n      <div className=\"w-12 text-right text-xs text-gray-500 bg-gray-50 border-r border-gray-200 py-1 px-2 select-none\">\n        {line.lineNumber}\n      </div>\n\n      {/* Line Content */}\n      <div className=\"flex-1 py-1 px-3 min-h-[28px] flex items-center hover:bg-gray-50 border-l-2 border-transparent hover:border-blue-200 transition-colors\">\n        <div style={{ paddingLeft: `${line.indentLevel * 32}px` }}>\n          {renderLineContent()}\n        </div>\n      </div>\n\n      {/* Validation Indicator */}\n      {line.validation && (\n        <div className=\"px-2\">\n          <span\n            className={`text-sm ${\n              line.validation.type === 'error' ? 'text-red-500' : 'text-yellow-500'\n            }`}\n            title={line.validation.message}\n          >\n            {line.validation.type === 'error' ? '🔴' : '⚠️'}\n          </span>\n        </div>\n      )}\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2250, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/curation/components/DuplicateHandlingDialog.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\n\ninterface DuplicateHandlingDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onReplace: () => void;\n  onCancel: () => void;\n  duplicateId: string;\n  currentId: string;\n  message?: string;\n}\n\nexport default function DuplicateHandlingDialog({\n  isOpen,\n  onClose,\n  onReplace,\n  onCancel,\n  duplicateId,\n  currentId,\n  message\n}: DuplicateHandlingDialogProps) {\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  const handleReplace = async () => {\n    setIsProcessing(true);\n    try {\n      await onReplace();\n      onClose();\n    } catch (error) {\n      console.error('Replace failed:', error);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleCancel = () => {\n    onCancel();\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full mx-4\">\n        <div className=\"p-6\">\n          {/* Header */}\n          <div className=\"flex items-center mb-4\">\n            <div className=\"flex-shrink-0\">\n              <div className=\"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center\">\n                <svg \n                  className=\"w-6 h-6 text-yellow-600\" \n                  fill=\"none\" \n                  stroke=\"currentColor\" \n                  viewBox=\"0 0 24 24\"\n                >\n                  <path \n                    strokeLinecap=\"round\" \n                    strokeLinejoin=\"round\" \n                    strokeWidth={2} \n                    d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L4.346 16.5c-.77.833.192 2.5 1.732 2.5z\" \n                  />\n                </svg>\n              </div>\n            </div>\n            <div className=\"ml-4\">\n              <h3 className=\"text-lg font-medium text-gray-900\">\n                Duplicate Cell Line Detected\n              </h3>\n            </div>\n          </div>\n\n          {/* Content */}\n          <div className=\"mb-6\">\n            <p className=\"text-sm text-gray-600 mb-4\">\n              {message || `A cell line with ID \"${duplicateId}\" already exists in the database.`}\n            </p>\n            \n            <div className=\"bg-gray-50 rounded-lg p-4 space-y-2\">\n              <div className=\"text-sm\">\n                <span className=\"font-medium text-gray-700\">Current ID:</span>\n                <span className=\"ml-2 text-gray-900\">{currentId}</span>\n              </div>\n              <div className=\"text-sm\">\n                <span className=\"font-medium text-gray-700\">Conflicting ID:</span>\n                <span className=\"ml-2 text-red-600\">{duplicateId}</span>\n              </div>\n            </div>\n\n            <p className=\"text-sm text-gray-600 mt-4\">\n              What would you like to do?\n            </p>\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex items-center justify-end space-x-3\">\n            <button\n              onClick={handleCancel}\n              disabled={isProcessing}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              Cancel\n            </button>\n            <button\n              onClick={handleReplace}\n              disabled={isProcessing}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {isProcessing ? 'Replacing...' : 'Replace Existing'}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function DuplicateHandlingModal({\n  isOpen,\n  onClose,\n  duplicateError,\n  onReplace\n}: {\n  isOpen: boolean;\n  onClose: () => void;\n  duplicateError: {\n    existing_id: string;\n    current_id: string;\n    message: string;\n  } | null;\n  onReplace: () => Promise<void>;\n}) {\n  if (!duplicateError) return null;\n\n  return (\n    <DuplicateHandlingDialog\n      isOpen={isOpen}\n      onClose={onClose}\n      onReplace={onReplace}\n      onCancel={onClose}\n      duplicateId={duplicateError.existing_id}\n      currentId={duplicateError.current_id}\n      message={duplicateError.message}\n    />\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAce,SAAS,wBAAwB,EAC9C,MAAM,EACN,OAAO,EACP,SAAS,EACT,QAAQ,EACR,WAAW,EACX,SAAS,EACT,OAAO,EACsB;IAC7B,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,MAAM,gBAAgB;QACpB,gBAAgB;QAChB,IAAI;YACF,MAAM;YACN;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,mBAAmB;QACnC,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,MAAM,eAAe;QACnB;QACA;IACF;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC;wCACC,WAAU;wCACV,MAAK;wCACL,QAAO;wCACP,SAAQ;kDAER,cAAA,8OAAC;4CACC,eAAc;4CACd,gBAAe;4CACf,aAAa;4CACb,GAAE;;;;;;;;;;;;;;;;;;;;;0CAKV,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAG,WAAU;8CAAoC;;;;;;;;;;;;;;;;;kCAOtD,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAE,WAAU;0CACV,WAAW,CAAC,qBAAqB,EAAE,YAAY,iCAAiC,CAAC;;;;;;0CAGpF,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAK,WAAU;0DAA4B;;;;;;0DAC5C,8OAAC;gDAAK,WAAU;0DAAsB;;;;;;;;;;;;kDAExC,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAK,WAAU;0DAA4B;;;;;;0DAC5C,8OAAC;gDAAK,WAAU;0DAAqB;;;;;;;;;;;;;;;;;;0CAIzC,8OAAC;gCAAE,WAAU;0CAA6B;;;;;;;;;;;;kCAM5C,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,SAAS;gCACT,UAAU;gCACV,WAAU;0CACX;;;;;;0CAGD,8OAAC;gCACC,SAAS;gCACT,UAAU;gCACV,WAAU;0CAET,eAAe,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO/C;AAEO,SAAS,uBAAuB,EACrC,MAAM,EACN,OAAO,EACP,cAAc,EACd,SAAS,EAUV;IACC,IAAI,CAAC,gBAAgB,OAAO;IAE5B,qBACE,8OAAC;QACC,QAAQ;QACR,SAAS;QACT,WAAW;QACX,UAAU;QACV,aAAa,eAAe,WAAW;QACvC,WAAW,eAAe,UAAU;QACpC,SAAS,eAAe,OAAO;;;;;;AAGrC","debugId":null}},
    {"offset": {"line": 2494, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/curation/components/CurationCellLineEditor.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { useSchemaData } from '../../editor/hooks/useSchemaData';\nimport { ErrorBoundary } from '../../editor/components/ErrorBoundary';\nimport { DisplayLine, CellLineData, FieldSchema } from '../../editor/types/editor';\nimport EditorLine from '../../editor/components/EditorLine';\nimport { API_ENDPOINTS } from '../../../../lib/api';\nimport { DuplicateHandlingModal } from './DuplicateHandlingDialog';\n\ninterface CurationCellLineEditorProps {\n  cellLineId: string;\n  cellLineData: any;\n  onSave?: (savedData: any) => void;\n  onError?: (error: string) => void;\n}\n\n// Parse JSON data to display lines (borrowed from CustomCellLineEditor)\nfunction parseDataToLines(data: any, schema: FieldSchema, path: string[] = [], indentLevel: number = 0, globalLineNumber: { current: number } = { current: 1 }): DisplayLine[] {\n  const lines: DisplayLine[] = [];\n\n  function addLine(\n    type: DisplayLine['type'],\n    fieldPath: string[],\n    displayText: string,\n    value: any,\n    isCollapsible: boolean = false,\n    isEditable: boolean = false,\n    customIndentLevel?: number\n  ): DisplayLine {\n    const line: DisplayLine = {\n      lineNumber: globalLineNumber.current++,\n      type,\n      fieldPath,\n      displayText,\n      isCollapsible,\n      isCollapsed: true,\n      isEditable,\n      value,\n      indentLevel: customIndentLevel !== undefined ? customIndentLevel : indentLevel,\n    };\n    lines.push(line);\n    return line;\n  }\n\n  if (typeof data === 'object' && data !== null) {\n    Object.entries(data).forEach(([key, value]) => {\n      const currentPath = [...path, key];\n      const fieldSchema = schema[key];\n\n      if (Array.isArray(value)) {\n        // Array field\n        addLine('object', currentPath, `${key}`, value, true, false, indentLevel);\n        value.forEach((item, index) => {\n          const itemPath = [...currentPath, index.toString()];\n          if (typeof item === 'object' && item !== null) {\n            lines.push(...parseDataToLines(item, fieldSchema || {}, itemPath, indentLevel + 1, globalLineNumber));\n          } else {\n            addLine('value', itemPath, `[${index}]: ${item}`, item, false, true, indentLevel + 1);\n          }\n        });\n      } else if (typeof value === 'object' && value !== null) {\n        // Nested object\n        addLine('object', currentPath, `${key}`, value, true, false, indentLevel);\n        lines.push(...parseDataToLines(value, fieldSchema || {}, currentPath, indentLevel + 1, globalLineNumber));\n      } else {\n        // Primitive value\n        const isEditable = fieldSchema?.editable !== false;\n        addLine('value', currentPath, `${key}: ${value}`, value, false, isEditable, indentLevel);\n      }\n    });\n  }\n\n  return lines;\n}\n\nexport default function CurationCellLineEditor({ \n  cellLineId, \n  cellLineData, \n  onSave, \n  onError \n}: CurationCellLineEditorProps) {\n  const { schema, isLoading: schemaLoading, error: schemaError } = useSchemaData();\n  \n  const [displayLines, setDisplayLines] = useState<DisplayLine[]>([]);\n  const [editingLine, setEditingLine] = useState<number | null>(null);\n  const [isSaving, setIsSaving] = useState(false);\n  const [saveError, setSaveError] = useState<string | null>(null);\n  const [changeHistory, setChangeHistory] = useState<any[]>([]);\n  const [canUndo, setCanUndo] = useState(false);\n  const [workingData, setWorkingData] = useState<CellLineData | null>(null);\n  const [duplicateDialogOpen, setDuplicateDialogOpen] = useState(false);\n  const [duplicateError, setDuplicateError] = useState<{\n    existing_id: string;\n    current_id: string;\n    message: string;\n  } | null>(null);\n  const [pendingSaveData, setPendingSaveData] = useState<any>(null);\n\n  // Initialize working data when cellLineData changes\n  useEffect(() => {\n    if (cellLineData) {\n      setWorkingData({ ...cellLineData });\n    }\n  }, [cellLineData]);\n\n  // Generate display lines when data or schema changes\n  const parsedLines = useMemo(() => {\n    if (!workingData || !schema) return [];\n    try {\n      return parseDataToLines(workingData, schema);\n    } catch (error) {\n      console.error('Error parsing data to lines:', error);\n      return [];\n    }\n  }, [workingData, schema]);\n\n  useEffect(() => {\n    setDisplayLines(parsedLines);\n  }, [parsedLines]);\n\n  // Handle field value changes\n  const handleValueChange = (lineNumber: number, newValue: any) => {\n    const line = displayLines.find(l => l.lineNumber === lineNumber);\n    if (!line || !workingData) return;\n\n    // Save current state to history for undo\n    setChangeHistory(prev => [...prev, { ...workingData }]);\n    setCanUndo(true);\n\n    // Update the working data\n    const newData = { ...workingData };\n    let current = newData;\n    \n    // Navigate to the field and update it\n    for (let i = 0; i < line.fieldPath.length - 1; i++) {\n      const key = line.fieldPath[i];\n      if (current[key] === undefined) {\n        current[key] = {};\n      }\n      current = current[key];\n    }\n    \n    const finalKey = line.fieldPath[line.fieldPath.length - 1];\n    current[finalKey] = newValue;\n    \n    setWorkingData(newData);\n    setSaveError(null);\n  };\n\n  // Handle save\n  const handleSave = async (forceReplace: boolean = false) => {\n    if (!workingData) return;\n\n    setIsSaving(true);\n    setSaveError(null);\n\n    try {\n      const saveData = forceReplace \n        ? { ...workingData, force_replace: true }\n        : workingData;\n\n      const response = await fetch(API_ENDPOINTS.CURATION.SAVE_CELLLINE(cellLineId), {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(saveData),\n      });\n\n      const result = await response.json();\n\n      if (!response.ok) {\n        if (result.error === 'duplicate_id' && !forceReplace) {\n          // Show duplicate handling dialog\n          setDuplicateError({\n            existing_id: result.existing_id,\n            current_id: result.current_id,\n            message: result.message\n          });\n          setPendingSaveData(workingData);\n          setDuplicateDialogOpen(true);\n          return;\n        } else {\n          throw new Error(result.error || result.message || 'Failed to save cell line');\n        }\n      }\n\n      // Clear change history on successful save\n      setChangeHistory([]);\n      setCanUndo(false);\n      \n      onSave?.(result.cell_line);\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Failed to save cell line';\n      setSaveError(errorMessage);\n      onError?.(errorMessage);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  // Handle duplicate replacement\n  const handleDuplicateReplace = async () => {\n    if (!pendingSaveData) return;\n    \n    try {\n      await handleSave(true);\n      setDuplicateDialogOpen(false);\n      setDuplicateError(null);\n      setPendingSaveData(null);\n    } catch (error) {\n      console.error('Replace failed:', error);\n    }\n  };\n\n  // Handle duplicate dialog close\n  const handleDuplicateDialogClose = () => {\n    setDuplicateDialogOpen(false);\n    setDuplicateError(null);\n    setPendingSaveData(null);\n  };\n\n  // Handle undo\n  const handleUndo = () => {\n    if (changeHistory.length === 0) return;\n    \n    const lastState = changeHistory[changeHistory.length - 1];\n    setWorkingData(lastState);\n    setChangeHistory(prev => prev.slice(0, -1));\n    setCanUndo(changeHistory.length > 1);\n  };\n\n  // Handle revert to original\n  const handleRevert = () => {\n    if (cellLineData) {\n      setWorkingData({ ...cellLineData });\n      setChangeHistory([]);\n      setCanUndo(false);\n      setSaveError(null);\n    }\n  };\n\n  const hasChanges = workingData && cellLineData && \n    JSON.stringify(workingData) !== JSON.stringify(cellLineData);\n\n  if (schemaLoading) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <div className=\"text-gray-500\">Loading schema...</div>\n      </div>\n    );\n  }\n\n  if (schemaError) {\n    return (\n      <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n        <p className=\"text-red-700\">Error loading schema: {schemaError}</p>\n      </div>\n    );\n  }\n\n  if (!workingData) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <div className=\"text-gray-500\">Loading cell line data...</div>\n      </div>\n    );\n  }\n\n  return (\n    <ErrorBoundary>\n      <div className=\"space-y-4\">\n        {/* Action buttons */}\n        <div className=\"flex items-center justify-between bg-gray-50 px-4 py-2 rounded-lg\">\n          <div className=\"flex items-center space-x-4\">\n            <button\n              onClick={handleSave}\n              disabled={!hasChanges || isSaving}\n              className={`px-4 py-2 rounded-md text-sm font-medium ${\n                hasChanges && !isSaving\n                  ? 'bg-blue-600 text-white hover:bg-blue-700'\n                  : 'bg-gray-300 text-gray-500 cursor-not-allowed'\n              }`}\n            >\n              {isSaving ? 'Saving...' : 'Save Changes'}\n            </button>\n            \n            <button\n              onClick={handleUndo}\n              disabled={!canUndo || isSaving}\n              className={`px-4 py-2 rounded-md text-sm font-medium ${\n                canUndo && !isSaving\n                  ? 'bg-gray-600 text-white hover:bg-gray-700'\n                  : 'bg-gray-300 text-gray-500 cursor-not-allowed'\n              }`}\n            >\n              Undo\n            </button>\n            \n            <button\n              onClick={handleRevert}\n              disabled={!hasChanges || isSaving}\n              className={`px-4 py-2 rounded-md text-sm font-medium ${\n                hasChanges && !isSaving\n                  ? 'bg-red-600 text-white hover:bg-red-700'\n                  : 'bg-gray-300 text-gray-500 cursor-not-allowed'\n              }`}\n            >\n              Revert All\n            </button>\n          </div>\n\n          {hasChanges && (\n            <div className=\"text-sm text-amber-600 font-medium\">\n              Unsaved changes\n            </div>\n          )}\n        </div>\n\n        {/* Error display */}\n        {saveError && (\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n            <p className=\"text-red-700 text-sm\">{saveError}</p>\n          </div>\n        )}\n\n        {/* Editor lines */}\n        <div className=\"bg-white border border-gray-200 rounded-lg\">\n          <div className=\"max-h-96 overflow-y-auto p-4\">\n            {displayLines.map((line) => (\n              <EditorLine\n                key={line.lineNumber}\n                line={line}\n                isEditing={editingLine === line.lineNumber}\n                onStartEdit={() => setEditingLine(line.lineNumber)}\n                onFinishEdit={() => setEditingLine(null)}\n                onValueChange={(newValue) => handleValueChange(line.lineNumber, newValue)}\n              />\n            ))}\n          </div>\n        </div>\n        \n        {/* Duplicate handling dialog */}\n        <DuplicateHandlingModal\n          isOpen={duplicateDialogOpen}\n          onClose={handleDuplicateDialogClose}\n          duplicateError={duplicateError}\n          onReplace={handleDuplicateReplace}\n        />\n      </div>\n    </ErrorBoundary>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2901, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/tools/curation/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { ArticlesTable } from './components/ArticlesTable';\nimport { CurationActions } from './components/CurationActions';\nimport { ErrorModal } from './components/ErrorModal';\nimport { ErrorBoundary } from '../editor/components/ErrorBoundary';\nimport { useStatusPolling } from './hooks/useStatusPolling';\nimport { API_ENDPOINTS } from '../../../lib/api';\nimport CurationCellLineEditor from './components/CurationCellLineEditor';\n\ninterface Article {\n  id: number;\n  filename: string;\n  pubmed_id: number | null;\n  created_on: string;\n  modified_on: string;\n  curation_status: 'pending' | 'processing' | 'completed' | 'failed';\n  curation_error: string | null;\n  curation_started_at: string | null;\n  transcription_status: string;\n  is_curated: boolean;\n  approximate_tokens: number;\n}\n\ninterface ErrorDetails {\n  article_id: number;\n  error_message: string;\n  curation_status: string;\n  failed_at: string;\n  filename?: string;\n  pubmed_id?: number | null;\n}\n\ninterface CellLine {\n  CellLine_hpscreg_id: string;\n  CellLine_cell_line_type: string;\n  CellLine_source_cell_type: string;\n  work_status: string;\n  source_article: number;\n  created_on: string;\n  modified_on: string;\n  [key: string]: any;\n}\n\ninterface CurationResult {\n  article_id: number;\n  article_pubmed_id: number | null;\n  status: 'processing' | 'completed' | 'failed';\n  cell_lines: CellLine[];\n  total_found?: number;\n  error?: string;\n}\n\nexport default function CurationPage() {\n  const [selectedArticles, setSelectedArticles] = useState<number[]>([]);\n  const [isPolling, setIsPolling] = useState(false);\n  const [errorModalOpen, setErrorModalOpen] = useState(false);\n  const [errorDetails, setErrorDetails] = useState<ErrorDetails | null>(null);\n  const [errorDetailsLoading, setErrorDetailsLoading] = useState(false);\n  \n  // New state for three-section workflow\n  const [curationResults, setCurationResults] = useState<Map<number, CurationResult>>(new Map());\n  const [allCuratedCellLines, setAllCuratedCellLines] = useState<CellLine[]>([]);\n  const [selectedCellLineId, setSelectedCellLineId] = useState<string | null>(null);\n  const [selectedCellLineData, setSelectedCellLineData] = useState<CellLine | null>(null);\n  const [curationInProgress, setCurationInProgress] = useState(false);\n\n  // Initial articles fetch\n  const [initialArticles, setInitialArticles] = useState<Article[]>([]);\n  const [initialLoading, setInitialLoading] = useState(true);\n  const [initialError, setInitialError] = useState<string | null>(null);\n\n  useEffect(() => {\n    fetchInitialArticles();\n  }, []);\n\n  const fetchInitialArticles = async () => {\n    try {\n      setInitialLoading(true);\n      const response = await fetch(API_ENDPOINTS.CURATION.ARTICLES);\n      if (!response.ok) throw new Error('Failed to fetch articles');\n      const data = await response.json();\n      setInitialArticles(data.articles);\n    } catch (err) {\n      setInitialError(err instanceof Error ? err.message : 'Failed to load articles');\n    } finally {\n      setInitialLoading(false);\n    }\n  };\n\n  // Real-time status polling with seamless background updates\n  const {\n    articles,\n    status,\n    loading: pollingLoading,\n    error: pollingError,\n    refresh,\n    startPolling,\n    stopPolling\n  } = useStatusPolling(initialArticles, isPolling, 3000);\n\n  // Start polling when curation is initiated\n  const handleCurationStart = useCallback(() => {\n    setIsPolling(true);\n    setCurationInProgress(true);\n    setSelectedArticles([]);\n    setCurationResults(new Map());\n    setAllCuratedCellLines([]);\n    setSelectedCellLineId(null);\n    setSelectedCellLineData(null);\n    // Initial refresh to get updated status\n    refresh();\n  }, [refresh]);\n\n  // Fetch cell lines for completed articles\n  const fetchCellLinesForArticle = useCallback(async (articleId: number) => {\n    try {\n      const response = await fetch(`${API_ENDPOINTS.CURATION.BASE}/${articleId}/celllines/`);\n      if (!response.ok) throw new Error('Failed to fetch cell lines');\n      const data = await response.json();\n      \n      const result: CurationResult = {\n        article_id: data.article_id,\n        article_pubmed_id: data.article_pubmed_id,\n        status: 'completed',\n        cell_lines: data.cell_lines,\n        total_found: data.count\n      };\n      \n      return result;\n    } catch (error) {\n      console.error(`Failed to fetch cell lines for article ${articleId}:`, error);\n      return {\n        article_id: articleId,\n        article_pubmed_id: null,\n        status: 'failed' as const,\n        cell_lines: [],\n        error: error instanceof Error ? error.message : 'Failed to fetch cell lines'\n      };\n    }\n  }, []);\n\n  // Update curation results when articles complete\n  useEffect(() => {\n    if (curationInProgress && articles.length > 0) {\n      articles.forEach(async (article) => {\n        if (article.curation_status === 'completed' && !curationResults.has(article.id)) {\n          const result = await fetchCellLinesForArticle(article.id);\n          setCurationResults(prev => new Map(prev.set(article.id, result)));\n        }\n      });\n    }\n  }, [articles, curationInProgress, curationResults, fetchCellLinesForArticle]);\n\n  // Update flattened cell lines list when curation results change\n  useEffect(() => {\n    const flattenedCellLines: CellLine[] = [];\n    curationResults.forEach(result => {\n      flattenedCellLines.push(...result.cell_lines);\n    });\n    setAllCuratedCellLines(flattenedCellLines);\n  }, [curationResults]);\n\n  // Stop polling when all processing is complete\n  useEffect(() => {\n    if (status && status.processing_count === 0 && isPolling) {\n      // Wait a bit to ensure all updates are processed\n      const timeout = setTimeout(() => {\n        setIsPolling(false);\n        setCurationInProgress(false);\n      }, 5000);\n      \n      return () => clearTimeout(timeout);\n    }\n  }, [status, isPolling]);\n\n  // Handle error modal\n  const handleErrorClick = useCallback(async (articleId: number) => {\n    setErrorDetailsLoading(true);\n    setErrorModalOpen(true);\n    \n    try {\n      const response = await fetch(API_ENDPOINTS.CURATION.ERROR_DETAILS(articleId));\n      if (!response.ok) throw new Error('Failed to fetch error details');\n      \n      const data = await response.json();\n      setErrorDetails(data);\n    } catch (err) {\n      setErrorDetails({\n        article_id: articleId,\n        error_message: 'Failed to load error details',\n        curation_status: 'failed',\n        failed_at: new Date().toISOString()\n      });\n    } finally {\n      setErrorDetailsLoading(false);\n    }\n  }, []);\n\n  const handleErrorModalClose = useCallback(() => {\n    setErrorModalOpen(false);\n    setErrorDetails(null);\n  }, []);\n\n  // Handle retry functionality\n  const handleRetryClick = useCallback(async (articleId: number) => {\n    try {\n      const response = await fetch(API_ENDPOINTS.CURATION.RETRY(articleId), {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to retry curation');\n      }\n\n      // Start polling to track the retried article\n      setIsPolling(true);\n      \n      // Refresh immediately to show processing status\n      refresh();\n    } catch (err) {\n      console.error('Retry failed:', err);\n      throw err; // Re-throw so the table component can handle it\n    }\n  }, [refresh]);\n\n  // Handle cell line selection for editing\n  const handleCellLineSelect = useCallback((cellLineId: string) => {\n    setSelectedCellLineId(cellLineId);\n    const cellLine = allCuratedCellLines.find(cl => cl.CellLine_hpscreg_id === cellLineId);\n    setSelectedCellLineData(cellLine || null);\n  }, [allCuratedCellLines]);\n\n  // Handle cell line save success\n  const handleCellLineSave = useCallback((savedData: any) => {\n    // Update the cell line in the curated cell lines list\n    setAllCuratedCellLines(prev => \n      prev.map(cellLine => \n        cellLine.CellLine_hpscreg_id === savedData.CellLine_hpscreg_id \n          ? { ...cellLine, ...savedData }\n          : cellLine\n      )\n    );\n    // Update the selected cell line data\n    setSelectedCellLineData(savedData);\n  }, []);\n\n  // Handle cell line save error\n  const handleCellLineError = useCallback((error: string) => {\n    console.error('Cell line save error:', error);\n    // The error is already displayed in the editor component\n  }, []);\n\n  // Combine loading states\n  const isLoading = initialLoading || (isPolling && pollingLoading);\n  const error = initialError || pollingError;\n\n  return (\n    <ErrorBoundary>\n      <div className=\"p-6 max-w-7xl mx-auto\">\n        <div className=\"mb-6\">\n          <h1 className=\"text-2xl font-bold text-gray-900\">Article Curation</h1>\n          <p className=\"text-gray-600 mt-2\">\n            Select articles to curate using AI-assisted processing. \n            Maximum 20 articles can be processed at once.\n          </p>\n        </div>\n\n        {error && (\n          <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg\">\n            <p className=\"text-red-700\">{error}</p>\n            <button \n              onClick={fetchInitialArticles}\n              className=\"mt-2 text-red-600 hover:text-red-800 underline\"\n            >\n              Retry\n            </button>\n          </div>\n        )}\n\n        {status && (\n          <div className=\"mb-4 grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n              <div className=\"text-2xl font-bold text-gray-900\">{status.total_count}</div>\n              <div className=\"text-sm text-gray-500\">Total Articles</div>\n            </div>\n            <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n              <div className=\"text-2xl font-bold text-blue-600\">{status.processing_count}</div>\n              <div className=\"text-sm text-gray-500\">Processing</div>\n            </div>\n            <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n              <div className=\"text-2xl font-bold text-green-600\">{status.completed_count}</div>\n              <div className=\"text-sm text-gray-500\">Completed</div>\n            </div>\n            <div className=\"bg-white p-4 rounded-lg border border-gray-200\">\n              <div className=\"text-2xl font-bold text-red-600\">{status.failed_count}</div>\n              <div className=\"text-sm text-gray-500\">Failed</div>\n            </div>\n          </div>\n        )}\n\n        {/* Section 1: Article Selection */}\n        <div className=\"mb-8\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">1. Article Selection</h2>\n          <ArticlesTable\n            articles={articles}\n            selectedArticles={selectedArticles}\n            onSelectionChange={setSelectedArticles}\n            loading={isLoading}\n            onRefresh={refresh}\n            onErrorClick={handleErrorClick}\n            onRetryClick={handleRetryClick}\n            isPolling={isPolling}\n          />\n\n          <CurationActions\n            selectedArticles={selectedArticles}\n            onCurationStart={handleCurationStart}\n            isProcessing={isPolling}\n          />\n        </div>\n\n        {/* Section 2: Curation Results */}\n        <div className=\"mb-8\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">2. Curation Results</h2>\n          {curationInProgress || curationResults.size > 0 ? (\n            <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\n              {/* Progress indicators */}\n              {Array.from(curationResults.entries()).map(([articleId, result]) => (\n                <div key={articleId} className=\"mb-4 last:mb-0\">\n                  {result.status === 'completed' ? (\n                    <div className=\"text-green-600\">\n                      ✓ Found {result.total_found} cell lines in article {result.article_pubmed_id || articleId}\n                    </div>\n                  ) : result.status === 'failed' ? (\n                    <div className=\"text-red-600\">\n                      ✗ Failed to process article {result.article_pubmed_id || articleId}: {result.error}\n                    </div>\n                  ) : (\n                    <div className=\"text-blue-600\">\n                      Processing article {result.article_pubmed_id || articleId}...\n                    </div>\n                  )}\n                </div>\n              ))}\n              \n              {/* Processing articles (those not yet in results but should be processing) */}\n              {articles\n                .filter(article => \n                  selectedArticles.includes(article.id) && \n                  article.curation_status === 'processing' && \n                  !curationResults.has(article.id)\n                )\n                .map(article => (\n                  <div key={article.id} className=\"mb-4 text-blue-600\">\n                    Processing article {article.pubmed_id || article.id}...\n                  </div>\n                ))\n              }\n              \n              {/* Cell lines table */}\n              {allCuratedCellLines.length > 0 && (\n                <div className=\"mt-6\">\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-3\">Curated Cell Lines</h3>\n                  <div className=\"overflow-x-auto\">\n                    <table className=\"min-w-full divide-y divide-gray-200\">\n                      <thead className=\"bg-gray-50\">\n                        <tr>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                            ID\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                            Type\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                            Source\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                            Status\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                            Source Article\n                          </th>\n                        </tr>\n                      </thead>\n                      <tbody className=\"bg-white divide-y divide-gray-200\">\n                        {allCuratedCellLines.map((cellLine) => (\n                          <tr \n                            key={cellLine.CellLine_hpscreg_id}\n                            className={`cursor-pointer hover:bg-gray-50 ${\n                              selectedCellLineId === cellLine.CellLine_hpscreg_id ? 'bg-blue-50' : ''\n                            }`}\n                            onClick={() => handleCellLineSelect(cellLine.CellLine_hpscreg_id)}\n                          >\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                              {cellLine.CellLine_hpscreg_id}\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                              {cellLine.CellLine_cell_line_type}\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                              {cellLine.CellLine_source_cell_type}\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap\">\n                              <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                                cellLine.work_status === 'in progress' ? 'bg-yellow-100 text-yellow-800' :\n                                cellLine.work_status === 'for review' ? 'bg-blue-100 text-blue-800' :\n                                'bg-green-100 text-green-800'\n                              }`}>\n                                {cellLine.work_status}\n                              </span>\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                              {cellLine.source_article}\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              )}\n            </div>\n          ) : (\n            <div className=\"bg-gray-50 rounded-lg border border-gray-200 p-6 text-center text-gray-500\">\n              Results will appear here when curation is started\n            </div>\n          )}\n        </div>\n\n        {/* Section 3: Cell Line Editor */}\n        <div className=\"mb-8\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">3. Cell Line Editor</h2>\n          {selectedCellLineId && selectedCellLineData ? (\n            <div className=\"bg-white rounded-lg border border-gray-200 p-6\">\n              <div className=\"mb-4\">\n                <h3 className=\"text-lg font-medium text-gray-900\">\n                  Editing: {selectedCellLineId}\n                </h3>\n                <p className=\"text-sm text-gray-600\">\n                  Type: {selectedCellLineData.CellLine_cell_line_type} • \n                  Source: {selectedCellLineData.CellLine_source_cell_type} • \n                  Status: {selectedCellLineData.work_status}\n                </p>\n              </div>\n              \n              <CurationCellLineEditor\n                cellLineId={selectedCellLineId}\n                cellLineData={selectedCellLineData}\n                onSave={handleCellLineSave}\n                onError={handleCellLineError}\n              />\n            </div>\n          ) : (\n            <div className=\"bg-gray-50 rounded-lg border border-gray-200 p-6 text-center text-gray-500\">\n              Select a cell line from the results above to edit\n            </div>\n          )}\n        </div>\n\n        <ErrorModal\n          isOpen={errorModalOpen}\n          onClose={handleErrorModalClose}\n          errorDetails={errorDetails}\n          loading={errorDetailsLoading}\n        />\n      </div>\n    </ErrorBoundary>\n  );\n} "],"names":[],"mappings":"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","debugId":null}}]
}