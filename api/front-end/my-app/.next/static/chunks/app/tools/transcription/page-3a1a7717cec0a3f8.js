(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[425],{4025:(e,t,r)=>{Promise.resolve().then(r.bind(r,7280))},6893:(e,t,r)=>{"use strict";t.a=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),a=r(2115),n=function(e){return e&&e.__esModule?e:{default:e}}(a),l=r(8177);l.registerPlugin,l.FileStatus;var o=(0,l.supported)(),i=["setOptions","on","off","onOnce","appendTo","insertAfter","insertBefore","isAttachedTo","replaceElement","restoreElement","destroy"];t.a=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function, not "+typeof e);function t(e){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");var r=function(e,t){if(!e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&("object"==typeof t||"function"==typeof t)?t:e}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.allowFilesSync=!0,r}return t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e),s(t,[{key:"componentDidMount",value:function(){var e=this;if(this._input=this._element.querySelector('input[type="file"]'),this._inputClone=this._input.cloneNode(),o){var t=Object.assign({},this.props);if(t.onupdatefiles){var r=t.onupdatefiles;t.onupdatefiles=function(t){e.allowFilesSync=!1,r(t)}}this._pond=(0,l.create)(this._input,t),Object.keys(this._pond).filter(function(e){return!i.includes(e)}).forEach(function(t){e[t]=e._pond[t]})}}},{key:"componentWillUnmount",value:function(){if(this._pond){var e=document.createElement("div");e.append(this._pond.element),e.id="foo",this._pond.destroy(),this._pond=void 0,this._element.append(this._inputClone)}}},{key:"shouldComponentUpdate",value:function(){return!!this.allowFilesSync||(this.allowFilesSync=!0,!1)}},{key:"componentDidUpdate",value:function(){if(this._pond){var e=Object.assign({},this.props);delete e.onupdatefiles,this._pond.setOptions(e)}}},{key:"render",value:function(){var e=this,t=this.props,r=t.id,s=t.name,n=t.className,l=t.allowMultiple,o=t.required,i=t.captureMethod,d=t.acceptedFileTypes;return(0,a.createElement)("div",{className:"filepond--wrapper",ref:function(t){return e._element=t}},(0,a.createElement)("input",{type:"file",name:s,id:r,accept:d,multiple:l,required:o,className:n,capture:i}))}}]),t}(n.default.Component)},7280:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),a=r(2115);let n=e=>{let{records:t,onRecordDeleted:r,onUploadClick:n,onEditRecord:l}=e,[o,i]=(0,a.useState)(new Set),[d,c]=(0,a.useState)(""),[u,x]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),b=e=>{let t=new Set(o);t.has(e)?t.delete(e):t.add(e),i(t)},m=e=>{b(e)},f=e=>{u===e?"asc"===h?p("desc"):"desc"===h?(x(null),p(null)):p("asc"):(x(e),p("asc"))},g=async e=>{try{if((await fetch("http://localhost:8000/api/transcribed-articles/".concat(e,"/"),{method:"DELETE"})).ok){let t=new Set(o);t.delete(e),i(t),r&&r()}else console.error("Failed to delete record"),alert("Failed to delete record. Please try again.")}catch(e){console.error("Error deleting record:",e),alert("Error deleting record. Please try again.")}},y=(0,a.useMemo)(()=>{let e=t.filter(e=>{var t;return e.filename.toLowerCase().includes(d.toLowerCase())||(null==(t=e.pubmed_id)?void 0:t.toString().includes(d))||e.transcription_status.toLowerCase().includes(d.toLowerCase())||e.curation_status.toLowerCase().includes(d.toLowerCase())});return u&&h&&e.sort((e,t)=>{let r=e[u],s=t[u];if("pubmed_id"===u){if(null===r&&null===s)return 0;if(null===r)return"asc"===h?1:-1;if(null===s)return"asc"===h?-1:1}return("string"==typeof r&&(r=r.toLowerCase()),"string"==typeof s&&(s=s.toLowerCase()),null==r)?1:null==s?-1:r<s?"asc"===h?-1:1:r>s?"asc"===h?1:-1:0}),e},[t,d,u,h]),v=e=>(0,s.jsx)("svg",{className:"w-4 h-4 ml-1 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})});return(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("div",{className:"-m-1.5 overflow-x-auto",children:(0,s.jsx)("div",{className:"p-1.5 min-w-full inline-block align-middle",children:(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg divide-y divide-gray-200 dark:border-neutral-700 dark:divide-neutral-700",children:[(0,s.jsx)("div",{className:"py-3 px-4",children:(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Transcribed Articles"})}),(0,s.jsx)("div",{className:"py-3 px-4",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{className:"relative w-1/2",children:[(0,s.jsx)("label",{htmlFor:"hs-table-search",className:"sr-only",children:"Search"}),(0,s.jsx)("input",{type:"text",name:"hs-table-search",id:"hs-table-search",value:d,onChange:e=>c(e.target.value),className:"py-1.5 sm:py-2 px-3 ps-9 block w-full border-gray-200 shadow-2xs rounded-full sm:text-sm focus:z-10 focus:border-blue-500 focus:ring-blue-500 hover:border-blue-500 hover:ring-2 hover:ring-blue-200 hover:shadow-md transition-all duration-200 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-400 dark:placeholder-neutral-500 dark:focus:ring-neutral-600 dark:hover:border-blue-500 dark:hover:ring-2 dark:hover:ring-blue-800 dark:hover:shadow-md",placeholder:"Search for items"}),(0,s.jsx)("div",{className:"absolute inset-y-0 start-0 flex items-center pointer-events-none ps-3",children:(0,s.jsxs)("svg",{className:"size-4 text-gray-400 dark:text-neutral-500",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,s.jsx)("path",{d:"m21 21-4.3-4.3"})]})})]}),n&&(0,s.jsxs)("button",{type:"button",onClick:n,className:"py-1.5 sm:py-2 px-6 inline-flex items-center gap-x-2 text-sm font-medium rounded-full border border-transparent bg-gray-800 text-white hover:bg-gray-700 focus:outline-hidden focus:bg-gray-700 disabled:opacity-50 disabled:pointer-events-none transition-colors duration-200","aria-haspopup":"dialog","aria-expanded":"false","aria-controls":"hs-static-backdrop-modal","data-hs-overlay":"#hs-static-backdrop-modal",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Upload"]})]})}),(0,s.jsx)("div",{className:"overflow-hidden",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-neutral-700",children:[(0,s.jsx)("thead",{className:"bg-gray-50 dark:bg-neutral-700",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",className:"py-3 px-4 pe-0",children:(0,s.jsxs)("div",{className:"flex items-center h-5",children:[(0,s.jsx)("input",{id:"hs-table-search-checkbox-all",type:"checkbox",checked:y.length>0&&o.size===y.length,onChange:()=>{o.size===y.length?i(new Set):i(new Set(y.map(e=>e.id)))},className:"border-gray-200 rounded-sm text-blue-600 focus:ring-blue-500 dark:bg-neutral-700 dark:border-neutral-500 dark:checked:bg-blue-500 dark:checked:border-blue-500 dark:focus:ring-offset-gray-800"}),(0,s.jsx)("label",{htmlFor:"hs-table-search-checkbox-all",className:"sr-only",children:"Checkbox"})]})}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase dark:text-neutral-500",children:(0,s.jsxs)("button",{onClick:()=>f("filename"),className:"flex items-center hover:text-gray-700 dark:hover:text-neutral-300 hover:bg-gray-50 hover:shadow-[inset_0_0_0_2px_rgb(156_163_175)] dark:hover:bg-neutral-800 dark:hover:shadow-[inset_0_0_0_2px_rgb(115_115_115)] transition-all duration-200 rounded px-4 py-2",children:["File Name",v("filename")]})}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase dark:text-neutral-500",children:(0,s.jsxs)("button",{onClick:()=>f("pubmed_id"),className:"flex items-center hover:text-gray-700 dark:hover:text-neutral-300 hover:bg-gray-50 hover:shadow-[inset_0_0_0_2px_rgb(156_163_175)] dark:hover:bg-neutral-800 dark:hover:shadow-[inset_0_0_0_2px_rgb(115_115_115)] transition-all duration-200 rounded px-4 py-2",children:["PubMed ID",v("pubmed_id")]})}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-start text-xs font-medium text-gray-500 uppercase dark:text-neutral-500",children:(0,s.jsxs)("button",{onClick:()=>f("created_on"),className:"flex items-center hover:text-gray-700 dark:hover:text-neutral-300 hover:bg-gray-50 hover:shadow-[inset_0_0_0_2px_rgb(156_163_175)] dark:hover:bg-neutral-800 dark:hover:shadow-[inset_0_0_0_2px_rgb(115_115_115)] transition-all duration-200 rounded px-4 py-2",children:["Created At",v("created_on")]})}),(0,s.jsx)("th",{scope:"col",className:"px-3 py-3 text-start text-xs font-medium text-gray-500 uppercase dark:text-neutral-500 w-32",children:(0,s.jsxs)("button",{onClick:()=>f("transcription_status"),className:"flex items-center hover:text-gray-700 dark:hover:text-neutral-300 hover:bg-gray-50 hover:shadow-[inset_0_0_0_2px_rgb(156_163_175)] dark:hover:bg-neutral-800 dark:hover:shadow-[inset_0_0_0_2px_rgb(115_115_115)] transition-all duration-200 rounded px-4 py-2",children:["Transcription",v("transcription_status")]})}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 dark:text-neutral-500",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-neutral-700",children:y.map((e,t)=>(0,s.jsxs)("tr",{onClick:()=>m(e.id),className:"hover:bg-gray-50 hover:shadow-[inset_0_0_0_2px_rgb(156_163_175)] dark:hover:bg-neutral-800 dark:hover:shadow-[inset_0_0_0_2px_rgb(115_115_115)] transition-all duration-200 cursor-pointer",children:[(0,s.jsx)("td",{className:"py-3 ps-4",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"flex items-center h-5",children:[(0,s.jsx)("input",{id:"hs-table-search-checkbox-".concat(e.id),type:"checkbox",checked:o.has(e.id),onChange:()=>b(e.id),className:"border-gray-200 rounded-sm text-blue-600 focus:ring-blue-500 dark:bg-neutral-800 dark:border-neutral-700 dark:checked:bg-blue-500 dark:checked:border-blue-500 dark:focus:ring-offset-gray-800"}),(0,s.jsx)("label",{htmlFor:"hs-table-search-checkbox-".concat(e.id),className:"sr-only",children:"Checkbox"})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800 dark:text-neutral-200",children:e.filename}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-neutral-200",children:e.pubmed_id||"N/A"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-neutral-200",children:new Date(e.created_on).toLocaleString()}),(0,s.jsx)("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-800 dark:text-neutral-200",children:"completed"===e.transcription_status?(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-4 h-4 bg-green-400 rounded-full"})}):"failed"===e.transcription_status?(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-4 h-4 bg-red-400 rounded-full"})}):"processing"===e.transcription_status?(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-4 h-4 bg-blue-400 rounded-full"})}):(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-4 h-4 bg-gray-400 rounded-full"})})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-end text-sm font-medium",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:["completed"===e.transcription_status&&e.transcription_content&&(0,s.jsx)("button",{type:"button",onClick:()=>l&&l(e),className:"inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent text-blue-600 hover:text-blue-800 focus:outline-hidden focus:text-blue-800 disabled:opacity-50 disabled:pointer-events-none dark:text-blue-500 dark:hover:text-blue-400 dark:focus:text-blue-400 transition-colors duration-200",title:"Edit transcription",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,s.jsx)("button",{type:"button",onClick:()=>g(e.id),className:"inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent text-red-600 hover:text-black focus:outline-hidden focus:text-black disabled:opacity-50 disabled:pointer-events-none dark:text-red-500 dark:hover:text-white dark:focus:text-white transition-colors duration-200",title:"Delete record",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},e.id))})]})})]})})})})};var l=r(6893);let o=e=>{let{isOpen:t,onClose:r,onUploadComplete:n}=e,[o,i]=(0,a.useState)([]),[d,c]=(0,a.useState)("idle"),[u,x]=(0,a.useState)(!1),[h,p]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&"idle"===d&&r()};return t&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t,d,r]);let b=()=>{c("success"),n()},m=e=>{if(console.log("Upload error:",e),e&&e.body)try{let t=JSON.parse(e.body);if("duplicate"===t.error_type){c("duplicate"),p(t.message||"This article has already been transcribed.");return}}catch(e){}if(e&&"object"==typeof e&&"duplicate"===e.error_type){c("duplicate"),p(e.message||"This article has already been transcribed.");return}c("error"),p("An error occurred during upload. Please try again.")},f=()=>{c("idle"),p(""),i([])},g=()=>{i([]),c("idle"),p(""),x(!1),r()};return t?(0,s.jsxs)("div",{id:"hs-static-backdrop-modal",className:"fixed inset-0 z-50 overflow-x-hidden overflow-y-auto",role:"dialog",tabIndex:-1,"aria-labelledby":"hs-static-backdrop-modal-label","data-hs-overlay-keyboard":"false",children:[(0,s.jsx)("div",{className:"fixed inset-0 transition-opacity",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:"idle"===d?r:void 0}),(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,s.jsxs)("div",{className:"relative bg-white border border-gray-200 shadow-2xl rounded-xl max-w-2xl w-full max-h-[90vh] flex flex-col dark:bg-neutral-800 dark:border-neutral-700 transition-all duration-200 ".concat(u?"scale-95 opacity-0":"scale-100 opacity-100"),children:[(0,s.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 border-b border-gray-200 dark:border-neutral-700",children:[(0,s.jsx)("h3",{id:"hs-static-backdrop-modal-label",className:"font-bold text-gray-800 dark:text-white",children:"Upload Files"}),("idle"===d||"uploading"===d)&&(0,s.jsxs)("button",{type:"button",onClick:"idle"===d?r:void 0,disabled:"uploading"===d,className:"size-8 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-100 text-gray-800 hover:bg-gray-200 focus:outline-hidden focus:bg-gray-200 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-700 dark:hover:bg-neutral-600 dark:text-neutral-400 dark:focus:bg-neutral-600","aria-label":"Close",children:[(0,s.jsx)("span",{className:"sr-only",children:"Close"}),(0,s.jsxs)("svg",{className:"shrink-0 size-4",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M18 6 6 18"}),(0,s.jsx)("path",{d:"m6 6 12 12"})]})]})]}),(0,s.jsxs)("div",{className:"p-4 overflow-y-auto flex-1",children:["duplicate"===d?(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Article Already Transcribed"}),(0,s.jsx)("div",{className:"mt-2 text-sm text-yellow-700",children:(0,s.jsx)("p",{children:h})})]})]})}):"error"===d?(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Upload Error"}),(0,s.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,s.jsx)("p",{children:h})})]})]})}):null,(0,s.jsx)(l.a,{files:o,onupdatefiles:e=>{i(e)},allowMultiple:!0,maxFiles:20,server:{process:{url:"http://localhost:8000/api/transcription/create_article/",method:"POST",onload:e=>{try{let t=JSON.parse(e);if(!1===t.success)return m({body:e}),null;if(!0===t.success)return b(),e}catch(e){}return b(),e},onerror:e=>(m(e),e)}},name:"files",labelIdle:'Drag and drop files to upload... (or <span class="filepond--label-action">browse)</span>.',acceptedFileTypes:["audio/*","video/*"],onprocessfilestart:()=>{c("uploading")}})]}),(0,s.jsxs)("div",{className:"flex justify-end items-center gap-x-2 py-3 px-4 border-t border-gray-200 dark:border-neutral-700",children:["idle"===d&&(0,s.jsx)("button",{type:"button",onClick:r,className:"py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-2xs hover:bg-gray-50 focus:outline-hidden focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700 dark:focus:bg-neutral-700",children:"Close"}),("success"===d||"uploading"===d)&&(0,s.jsx)("button",{type:"button",onClick:()=>{x(!0),setTimeout(()=>{g()},200)},disabled:"uploading"===d,className:"py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg bg-green-600 text-white shadow-2xs hover:bg-green-700 focus:outline-hidden focus:bg-green-700 disabled:opacity-50 disabled:pointer-events-none disabled:bg-gray-400",children:"OK"}),"duplicate"===d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{type:"button",onClick:g,className:"py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-2xs hover:bg-gray-50 focus:outline-hidden focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700 dark:focus:bg-neutral-700",children:"Close"}),(0,s.jsx)("button",{type:"button",onClick:f,className:"py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg bg-yellow-600 text-white shadow-2xs hover:bg-yellow-700 focus:outline-hidden focus:bg-yellow-700 disabled:opacity-50 disabled:pointer-events-none",children:"Upload Different File"})]}),"error"===d&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{type:"button",onClick:g,className:"py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-2xs hover:bg-gray-50 focus:outline-hidden focus:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700 dark:focus:bg-neutral-700",children:"Close"}),(0,s.jsx)("button",{type:"button",onClick:f,className:"py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg bg-blue-600 text-white shadow-2xs hover:bg-blue-700 focus:outline-hidden focus:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none",children:"Retry"})]})]})]})})]}):null},i=e=>{let{selectedRecord:t,onClose:r,onSave:n}=e,[l,o]=(0,a.useState)(""),[i,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(!1),[x,h]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),[m,f]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t&&(o(t.transcription_content||""),d(t.transcription_content||""),h(null),b(null))},[t]),(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&(l!==i?f(!0):r())};return t&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t,r,l,i]);let g=async()=>{if(t){u(!0),h(null),b(null);try{await n(t.id,l),b("Transcription saved successfully!"),d(l)}catch(e){h(e instanceof Error?e.message:"Failed to save transcription")}finally{u(!1)}}},y=l!==i,v=async()=>{f(!1),r();try{await n(t.id,l),d(l)}catch(e){console.error("Failed to save transcription:",e)}};return t?(0,s.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-[90vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Filename: ",t.filename]})}),(0,s.jsx)("button",{onClick:()=>{y?f(!0):r()},className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(x||p)&&(0,s.jsxs)("div",{className:"px-6 py-3",children:[x&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:x}),p&&(0,s.jsx)("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md",children:p})]}),(0,s.jsx)("div",{className:"flex-1 p-6",children:(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Content"}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["Token count: ",Math.ceil(l.length/4)," tokens"]})]}),(0,s.jsx)("textarea",{value:l,onChange:e=>o(e.target.value),className:"flex-1 w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none font-mono text-sm",placeholder:"Enter or edit transcription content..."})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["Last modified: ",new Date(t.modified_on).toLocaleString()]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("button",{onClick:()=>{o(i),h(null),b(null)},disabled:!y||c,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Revert Changes"}),(0,s.jsx)("button",{onClick:g,disabled:!y||c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Saving...":"Save Changes"})]})]})]}),m&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-60 p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Do you want to save your changes?"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>{f(!1),r()},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"No"}),(0,s.jsx)("button",{onClick:v,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Yes"})]})]})})]}):null},d=()=>{let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!1),[d,c]=(0,a.useState)(!1),[u,x]=(0,a.useState)(null),[h,p]=(0,a.useState)(!1),b=async()=>{try{let e=await fetch("http://localhost:8000/api/transcribed-articles/");if(e.ok){let r=await e.json();t(r)}else console.error("Failed to fetch transcribed articles")}catch(e){console.error("Error fetching transcribed articles:",e)}};(0,a.useEffect)(()=>{b();let e=setInterval(b,3e3);return()=>clearInterval(e)},[]);let m=async(e,t)=>{try{let r=await fetch("http://localhost:8000/api/transcribed-articles/".concat(e,"/update_transcription/"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcription_content:t})});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to save transcription")}await b()}catch(e){throw console.error("Error saving transcription:",e),e}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex flex-col gap-4 mb-6",children:(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Transcription Management"})}),(0,s.jsx)("div",{id:"records-table-section",className:"flex flex-col gap-4 bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:(0,s.jsx)(n,{records:e,onRecordDeleted:b,onUploadClick:()=>{c(!0)},onEditRecord:e=>{x(e),p(!0)}})}),(0,s.jsx)(o,{isOpen:d,onClose:()=>{c(!1)},onUploadComplete:()=>{b()}}),h&&u&&(0,s.jsx)(i,{selectedRecord:u,onClose:()=>{p(!1),x(null)},onSave:m})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[520,488,441,684,358],()=>t(4025)),_N_E=e.O()}]);